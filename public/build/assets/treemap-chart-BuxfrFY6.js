import{E as J,a as Q,D as Z,c as G,u as q,r as W,d as tt,t as R,i as D,b as et,e as I,v as S,C as k,f as nt,g as it}from"./auto-Bjo_A7Qx.js";/*!
 * chartjs-chart-treemap v3.1.0
 * https://chartjs-chart-treemap.pages.dev/
 * (c) 2024 Jukka Kurkela
 * Released under the MIT license
 */const ot=(e,t)=>t>e||e.length>t.length&&e.slice(0,t.length)===t,O=e=>""+e;function H(e,t,n,i=[],o=0,s=[]){const r=o-1;if(e[0]in n&&o>0){const a=i.reduce(function(h,l,f){return f!==r&&(h[O(f)]=l),h},{});a[t]=i[r],e.forEach(function(h){a[h]=n[h]}),s.push(a)}else for(const a of Object.keys(n)){const h=n[a];I(h)&&(i.push(a),H(e,t,h,i,o+1,s))}return i.splice(r,1),s}function st(e,t,n){const i=H(e,t,n);if(!i.length)return i;const o=i.reduce(function(s,r){const a=Object.keys(r).length-2;return s>a?s:a});return i.forEach(function(s){for(let r=0;r<o;r++){const a=O(r);s[a]||(s[a]="")}}),i}function rt(e){const t=[...e],n=[];for(;t.length;){const i=t.pop();Array.isArray(i)?t.push(...i):n.push(i)}return n.reverse()}function at(e,t,n){if(!e.length)return;const i=[];for(const o of e){const s=t[o];if(s===""){i.push(n);break}i.push(s)}return i.length?i.join("."):n}function ht(e,t,n,i,o,s,r=[]){const a=n[0],h=n.slice(1),l=Object.create(null),f=Object.create(null),d=[];let u,c,p;for(c=0,p=e.length;c<p;++c){const g=e[c];if(o&&g[o]!==s)continue;if(u=g[t]||g[i]||"",!(u in l)){const m=l[u]={value:0};h.forEach(function(w){m[w]=0}),f[u]=[]}l[u].value+=+g[a],l[u].label=g[t]||"";const b=l[u];h.forEach(function(m){b[m]+=g[m]}),l[u].path=at(r,g,u),f[u].push(g)}return Object.keys(l).forEach(g=>{const b={children:f[g]};b[a]=+l[g].value,h.forEach(function(m){b[m]=+l[g][m]}),b[t]=l[g].label,b.label=g,b.path=l[g].path,o&&(b[o]=s),d.push(b)}),d}function lt(e,t){let n=e.length,i;if(!n)return t;const o=I(e[0]);for(t=o?t:"v",i=0,n=e.length;i<n;++i)o?e[i]._idx=i:e[i]={v:e[i],_idx:i};return t}function ut(e,t){t?e.sort((n,i)=>+i[t]-+n[t]):e.sort((n,i)=>+i-+n)}function ct(e,t){let n,i,o;for(n=0,i=0,o=e.length;i<o;++i)n+=t?+e[i][t]:+e[i];return n}function ft(e,t,n,i=!0){const o=n.split(".");let s=0;for(const r of t.split(".")){const a=o[s++];if(parseInt(r,10)<parseInt(a,10))break;if(ot(a,r)){if(i)throw new Error(`${e} v${n} is not supported. v${t} or newer is required.`);return!1}}return!0}const P=new Map;function N(e,t){const{x:n,y:i,width:o,height:s}=e.getProps(["x","y","width","height"],t);return{left:n,top:i,right:n+o,bottom:i+s}}function _(e,t,n){return Math.max(Math.min(e,n),t)}function X(e,t,n){const i=nt(e);return{t:_(i.top,0,n),r:_(i.right,0,t),b:_(i.bottom,0,n),l:_(i.left,0,t)}}function dt(e,t,n){const i=it(e),o=Math.min(t,n);return{topLeft:_(i.topLeft,0,o),topRight:_(i.topRight,0,o),bottomLeft:_(i.bottomLeft,0,o),bottomRight:_(i.bottomRight,0,o)}}function pt(e){const t=N(e),n=t.right-t.left,i=t.bottom-t.top,o=X(e.options.borderWidth,n/2,i/2),s=dt(e.options.borderRadius,n/2,i/2),r={x:t.left,y:t.top,w:n,h:i,active:e.active,radius:s};return{outer:r,inner:{x:r.x+o.l,y:r.y+o.t,w:r.w-o.l-o.r,h:r.h-o.t-o.b,active:e.active,radius:{topLeft:Math.max(0,s.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,s.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(o.b,o.r))}}}}function E(e,t,n,i){const o=t===null,s=n===null,r=!e||o&&s?!1:N(e,i);return r&&(o||t>=r.left&&t<=r.right)&&(s||n>=r.top&&n<=r.bottom)}function gt(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function mt(e,t){e.rect(t.x,t.y,t.w,t.h)}function V(e,t){if(!t||t.display===!1)return!1;const{w:n,h:i}=e,s=R(t.font).lineHeight,r=_(S(t.padding,3)*2,0,Math.min(n,i));return n-r>s&&i-r>s}function bt(e,t,n,i,o){const{captions:s,labels:r}=n;e.save(),e.beginPath(),e.rect(t.x,t.y,t.w,t.h),e.clip();const a=i&&(!tt(i.l)||i.l===o);a&&r.display?Ct(e,t,n):!a&&V(t,s)&&wt(e,t,n,i),e.restore()}function wt(e,t,n,i){const{captions:o,spacing:s,rtl:r}=n,{color:a,hoverColor:h,font:l,hoverFont:f,padding:d,align:u,formatter:c}=o,p=(t.active?h:a)||a,g=u||(r?"right":"left"),b=(t.active?f:l)||l,m=R(b),w=m.lineHeight/2,y=Y(t,g,d);e.fillStyle=p,e.font=m.string,e.textAlign=g,e.textBaseline="middle",e.fillText(c||i.g,y,t.y+d+s+w)}function yt(e,t,n){const i=n.reduce(function(s,r){return s+=r.string,s},""),o=t.join()+i+(e._measureText?"-spriting":"");if(!P.has(o)){e.save();const s=t.length;let r=0,a=0;for(let h=0;h<s;h++){const l=n[Math.min(h,n.length-1)];e.font=l.string;const f=t[h];r=Math.max(r,e.measureText(f).width),a+=l.lineHeight}e.restore(),P.set(o,{width:r,height:a})}return P.get(o)}function vt(e,t){return e.map(function(n){return n.size=Math.floor(n.size*t),n.lineHeight=void 0,R(n)})}function _t(e,t,n,i){const{overflow:o,padding:s}=n,{width:r,height:a}=i;if(o==="hidden")return!(r+s*2>t.w||a+s*2>t.h);if(o==="fit"){const h=Math.min(t.w/(r+s*2),t.h/(a+s*2));if(h<1)return h}return!0}function xt(e,t){const{font:n,hoverFont:i}=t,o=(e.active?i:n)||n;return D(o)?o.map(s=>R(s)):[R(o)]}function Ct(e,t,n){const i=n.labels,o=i.formatter;if(!o)return;const s=D(o)?o:[o];let r=xt(t,i),a=yt(e,s,r);const h=_t(e,t,i,a);if(!h)return;et(h)&&(a={width:a.width*h,height:a.height*h},r=vt(r,h));const{color:l,hoverColor:f,align:d}=i,u=(t.active?f:l)||l,c=D(u)?u:[u],p=Mt(t,i,a);e.textAlign=d,e.textBaseline="middle";let g=0;s.forEach(function(b,m){const w=c[Math.min(m,c.length-1)],y=r[Math.min(m,r.length-1)],M=y.lineHeight;e.font=y.string,e.fillStyle=w,e.fillText(b,p.x,p.y+M/2+g),g+=M})}function Rt(e,t,n,i){const o=n.dividers;if(!o.display||!i._data.children.length)return;const{x:s,y:r,w:a,h}=t,{lineColor:l,lineCapStyle:f,lineDash:d,lineDashOffset:u,lineWidth:c}=o;if(e.save(),e.strokeStyle=l,e.lineCap=f,e.setLineDash(d),e.lineDashOffset=u,e.lineWidth=c,e.beginPath(),a>h){const p=a/2;e.moveTo(s+p,r),e.lineTo(s+p,r+h)}else{const p=h/2;e.moveTo(s,r+p),e.lineTo(s+a,r+p)}e.stroke(),e.restore()}function Mt(e,t,n){const{align:i,position:o,padding:s}=t;let r,a;return r=Y(e,i,s),o==="top"?a=e.y+s:o==="bottom"?a=e.y+e.h-s-n.height:a=e.y+(e.h-n.height)/2+s,{x:r,y:a}}function Y(e,t,n){return t==="left"?e.x+n:t==="right"?e.x+e.w-n:e.x+e.w/2}class T extends J{constructor(t){super(),this.options=void 0,this.width=void 0,this.height=void 0,t&&Object.assign(this,t)}draw(t,n,i=0){if(!n)return;const o=this.options,{inner:s,outer:r}=pt(this),a=gt(r.radius)?Q:mt;t.save(),(r.w!==s.w||r.h!==s.h)&&(t.beginPath(),a(t,r),t.clip(),a(t,s),t.fillStyle=o.borderColor,t.fill("evenodd")),t.beginPath(),a(t,s),t.fillStyle=o.backgroundColor,t.fill(),Rt(t,s,o,n),bt(t,s,o,n,i),t.restore()}inRange(t,n,i){return E(this,t,n,i)}inXRange(t,n){return E(this,t,null,n)}inYRange(t,n){return E(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,width:o,height:s}=this.getProps(["x","y","width","height"],t);return{x:n+o/2,y:i+s/2}}tooltipPosition(){return this.getCenterPoint()}getRange(t){return t==="x"?this.width/2:this.height/2}}T.id="treemap";T.defaults={borderRadius:0,borderWidth:0,captions:{align:void 0,color:"black",display:!0,font:{},formatter:e=>e.raw.g||e.raw._data.label||"",padding:3},dividers:{display:!1,lineCapStyle:"butt",lineColor:"black",lineDash:[],lineDashOffset:0,lineWidth:1},label:void 0,labels:{align:"center",color:"black",display:!1,font:{},formatter(e){return e.raw.g?[e.raw.g,e.raw.v+""]:e.raw._data.label?[e.raw._data.label,e.raw.v+""]:e.raw.v+""},overflow:"cut",position:"middle",padding:3},rtl:!1,spacing:.5,unsorted:!1};T.descriptors={captions:{_fallback:!0},labels:{_fallback:!0},_scriptable:!0,_indexable:!1};T.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function Tt(e,t,n,i){const o=e._normalized,s=t*o/n,r=Math.sqrt(o*s),a=o/r;return{d1:r,d2:a,w:i==="_ix"?r:a,h:i==="_ix"?a:r}}const Lt=(e,t)=>e.rtl?e.x+e.iw-t:e.x+e._ix;function Ot(e,t,n,i){const o={x:Lt(e,n.w),y:e.y+e._iy,w:n.w,h:n.h,a:t._normalized,v:t.value,vs:t.values,s:i,_data:t._data};return t.group&&(o.g=t.group,o.l=t.level,o.gs=t.groupSum),o}class Pt{constructor(t){t=t||{w:1,h:1},this.rtl=!!t.rtl,this.unsorted=!!t.unsorted,this.x=t.x||t.left||0,this.y=t.y||t.top||0,this._ix=0,this._iy=0,this.w=t.w||t.width||t.right-t.left,this.h=t.h||t.height||t.bottom-t.top}get area(){return this.w*this.h}get iw(){return this.w-this._ix}get ih(){return this.h-this._iy}get dir(){const t=this.ih;return t<=this.iw&&t>0?"y":"x"}get side(){return this.dir==="x"?this.iw:this.ih}map(t){const{dir:n,side:i}=this,o=n==="x"?"_ix":"_iy",s=t.nsum,r=t.get(),a=i*i,h=s*s,l=[];let f=0,d=0;for(const u of r){const c=Tt(u,a,h,o);d+=c.d1,f=Math.max(f,c.d2),l.push(Ot(this,u,c,t.sum)),this[o]+=c.d1}return this[n==="x"?"_iy":"_ix"]+=f,this[o]-=d,l}}const F=Math.min,z=Math.max;function Et(e){return{min:e.min,max:e.max,sum:e.sum,nmin:e.nmin,nmax:e.nmax,nsum:e.nsum}}function j(e,t){const n=+t[e.key],i=n*e.ratio;return t._normalized=i,{min:F(e.min,n),max:z(e.max,n),sum:e.sum+n,nmin:F(e.nmin,i),nmax:z(e.nmax,i),nsum:e.nsum+i}}function Dt(e,t){Object.assign(e,t)}function B(e,t,n){e._arr.push(t),Dt(e,n)}class St{constructor(t,n){const i=this;i.key=t,i.ratio=n,i.reset()}get length(){return this._arr.length}reset(){const t=this;t._arr=[],t._hist=[],t.sum=0,t.nsum=0,t.min=1/0,t.max=-1/0,t.nmin=1/0,t.nmax=-1/0}push(t){B(this,t,j(this,t))}pushIf(t,n,...i){const o=j(this,t);if(!n(Et(this),o,i))return t;B(this,t,o)}get(){return this._arr}}function It(e,t,n){if(e.sum===0)return!0;const[i]=n,o=e.nsum*e.nsum,s=t.nsum*t.nsum,r=i*i,a=Math.max(r*e.nmax/o,o/(r*e.nmin));return Math.max(r*t.nmax/s,s/(r*t.nmin))<=a}function K(e,t,n=[],i,o,s){e=e||[];const r=[],a=new Pt(t),h=new St("value",a.area/ct(e,n[0]));let l=a.side;const f=e.length;let d,u;if(!f)return r;const c=e.slice();let p=lt(c,n[0]);t!=null&&t.unsorted||ut(c,p);const g=m=>p?+c[m][p]:+c[m],b=m=>i&&c[m][i];for(d=0;d<f;++d){if(u={value:g(d),groupSum:s,_data:e[c[d]._idx],level:void 0,group:void 0},i){u.level=o,u.group=b(d);const m=c[d];u.values=n.reduce(function(w,y){return w[y]=+m[y],w},{})}u=h.pushIf(u,It,l),u&&(r.push(a.map(h)),l=a.side,h.reset(),h.push(u))}return h.length&&r.push(a.map(h)),rt(r)}var kt="3.1.0";function At(e,t,n,i){const o=i*2,s=t.getPixelForValue(e.x),r=n.getPixelForValue(e.y),a=t.getPixelForValue(e.x+e.w)-s,h=n.getPixelForValue(e.y+e.h)-r;return{x:s+i,y:r+i,width:a-o,height:h-o,hidden:o>a||o>h}}function Ft(e,t){return!e||!t||e.x!==t.x||e.y!==t.y||e.w!==t.w||e.h!==t.h||e.rtl!==t.rtl||e.unsorted!==t.unsorted}function $(e,t){let n,i;if(!e||!t)return!0;if(e===t)return!1;if(e.length!==t.length)return!0;for(n=0,i=e.length;n<i;++n)if(e[n]!==t[n])return!0;return!1}function zt(e,t,n,i){const o=t.treeLeafKey||"_leaf";I(e)&&(e=st(n,o,e));const s=t.groups||[],r=s.length,a=S(t.spacing,0),h=t.captions||{},l=R(h.font),f=S(h.padding,3);function d(u,c,p,g,b){const m=O(s[c]),w=c>0&&O(s[c-1]),y=ht(u,m,n,o,w,g,s.filter((v,C)=>C<=c)),M=K(y,p,n,m,c,b),A=M.slice();return c<r-1&&M.forEach(v=>{const C=X(t.borderWidth,v.w/2,v.h/2),L={...p,x:v.x+a+C.l,y:v.y+a+C.t,w:v.w-2*a-C.l-C.r,h:v.h-2*a-C.t-C.b};V(L,h)&&(L.y+=l.lineHeight+f*2,L.h-=l.lineHeight+f*2),y.forEach(U=>{A.push(...d(U.children,c+1,L,v.g,v.s))})}),A}return r?d(e,0,i):K(e,i,n)}class x extends Z{constructor(t,n){super(t,n),this._groups=void 0,this._keys=void 0,this._rect=void 0,this._rectChanged=!0}initialize(){this.enableOptionSharing=!0,super.initialize()}getMinMax(t){return{min:0,max:t.axis==="x"?t.right-t.left:t.bottom-t.top}}configure(){super.configure();const{xScale:t,yScale:n}=this.getMeta();if(!t||!n)return;const i=t.right-t.left,o=n.bottom-n.top,s={x:0,y:0,w:i,h:o,rtl:!!this.options.rtl,unsorted:!!this.options.unsorted};Ft(this._rect,s)&&(this._rect=s,this._rectChanged=!0),this._rectChanged&&(t.max=i,t.configure(),n.max=o,n.configure())}update(t){const n=this.getDataset(),{data:i}=this.getMeta(),o=n.groups||[],s=[n.key||""].concat(n.sumKeys||[]),r=n.tree=n.tree||n.data||[];t==="reset"&&this.configure(),(this._rectChanged||$(this._keys,s)||$(this._groups,o)||this._prevTree!==r)&&(this._groups=o.slice(),this._keys=s.slice(),this._prevTree=r,this._rectChanged=!1,n.data=zt(r,n,this._keys,this._rect),this._dataCheck(),this._resyncElements()),this.updateElements(i,0,i.length,t)}updateElements(t,n,i,o){const s=o==="reset",r=this.getDataset(),a=this._rect.options=this.resolveDataElementOptions(n,o),h=this.getSharedOptions(a),l=this.includeOptions(o,h),{xScale:f,yScale:d}=this.getMeta(this.index);for(let u=n;u<n+i;u++){const c=h||this.resolveDataElementOptions(u,o),p=At(r.data[u],f,d,c.spacing);s&&(p.width=0,p.height=0),l&&(p.options=c),this.updateElement(t[u],u,p,o)}this.updateSharedOptions(h,o,a)}draw(){const{ctx:t,chartArea:n}=this.chart,i=this.getMeta().data||[],o=this.getDataset(),s=(o.groups||[]).length-1,r=o.data;G(t,n);for(let a=0,h=i.length;a<h;++a){const l=i[a];l.hidden||l.draw(t,r[a],s)}q(t)}}x.id="treemap";x.version=kt;x.defaults={dataElementType:"treemap",animations:{numbers:{type:"number",properties:["x","y","width","height"]}}};x.descriptors={_scriptable:!0,_indexable:!1};x.overrides={interaction:{mode:"point",includeInvisible:!0,intersect:!0},hover:{},plugins:{tooltip:{position:"treemap",intersect:!0,callbacks:{title(e){return e.length&&e[0].dataset.key||""},label(e){const t=e.dataset,n=t.data[e.dataIndex],i=n.g||n._data.label||t.label;return(i?i+": ":"")+n.v}}}},scales:{x:{type:"linear",alignToPixels:!0,bounds:"data",display:!1},y:{type:"linear",alignToPixels:!0,bounds:"data",display:!1,reverse:!0}}};x.beforeRegister=function(){ft("chart.js","3.8",k.version)};x.afterRegister=function(){const e=W.plugins.get("tooltip");e?e.positioners.treemap=function(t){return t.length?t[t.length-1].element.tooltipPosition():!1}:console.warn("Unable to register the treemap positioner because tooltip plugin is not registered")};x.afterUnregister=function(){const e=W.plugins.get("tooltip");e&&delete e.positioners.treemap};k.register(x,T);Livewire.hook("component.init",({component:e,cleanup:t})=>{Alpine.data("treemapChart",()=>({chart:null,currentSeries:[],currentLabel:"",chartId:null,chartTitle:"",chartListener:"",initTreemapChart({id:n,series:i,label:o,title:s,listener:r}){this.chartId=n,this.currentSeries=i,this.currentLabel=o,this.chartTitle=s,this.chartListener=r,this.renderChart(),window.Livewire&&Livewire.on(r,({label:a,series:h})=>{this.destroyChart(),this.currentSeries=h,this.currentLabel=a,this.renderChart()})},updateTitle(n){this.chartTitle=n},renderChart(){const n=document.getElementById(`treemap-chart-${this.chartId}`);if(!n){console.error(`Canvas element not found: treemap-chart-${this.chartId}`);return}const i=n.getContext("2d");this.chart&&this.chart.destroy(),this.chart=new k(i,{type:"treemap",data:{datasets:[{label:this.currentLabel,tree:this.currentSeries,key:"value",borderWidth:0,borderRadius:6,spacing:1,backgroundColor:this.generateTreemapColor(this.currentSeries),labels:{align:"left",display:!0,formatter(o){if(o.type==="data")return[o.raw._data.what,"Value is "+o.raw.v]},color:["white","whiteSmoke"],font:[{size:16,weight:"200px"},{size:10}],position:"center"}}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!1,text:this.chartTitle},legend:{display:!1},tooltip:{enabled:!0,callbacks:{title(){return""},label(o){const s=o.raw._data,r=o.raw.v;return`${s.what}: ${r}`}}}}}})},destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)},generateTreemapColor(n){const i=n.map(a=>a.value),o=Math.min(...i),r=Math.max(...i)-o||1;return a=>a.type!=="data"?"transparent":`rgba(0, 153, 76, ${(.3+.7*((a.raw.v-o)/r)).toFixed(2)})`}}))});
